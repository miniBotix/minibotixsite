<!DOCTYPE html>
<html>
<head>
  <title>Minibotix | Login System</title>
  <style>
    #popup {
      display: none;
      position: fixed;
      top: 20%;
      left: 35%;
      width: 30%;
      padding: 20px;
      background: #111;
      color: #fff;
      border-radius: 15px;
      box-shadow: 0 0 10px #00f2ff;
      z-index: 999;
    }
    input, button {
      margin: 8px;
      padding: 10px;
      width: 90%;
    }
  </style>
</head>
<body style="background:#000;color:#0ff;font-family:sans-serif;text-align:center;">

  <h1>Welcome to Minibotix</h1>
  <p id="welcomeMessage">You are not logged in.</p>

  <button onclick="showLogin()">Login</button>
  <button onclick="showSignup()">Sign Up</button>

  <div id="popup">
    <h2 id="popupTitle">Login</h2>
    <input type="text" id="name" placeholder="Name" style="display:none;"><br>
    <input type="email" id="email" placeholder="Email"><br>
    <input type="password" id="password" placeholder="Password"><br>
    <button onclick="submitForm()">Submit</button>
    <button onclick="hidePopup()">Cancel</button>
  </div>

  <script>
    const scriptURL = "https://script.google.com/macros/s/AKfycbxd1lMrEz_4IOiyrqInG5TfKUpA4i_nb3UGtwJiwlh0Fr5F25R5fk7YjpJwom-LzQTc/exec";
    let mode = "login";

    function showLogin() {
      mode = "login";
      document.getElementById("popupTitle").innerText = "Login";
      document.getElementById("name").style.display = "none";
      document.getElementById("popup").style.display = "block";
    }

    function showSignup() {
      mode = "signup";
      document.getElementById("popupTitle").innerText = "Sign Up";
      document.getElementById("name").style.display = "block";
      document.getElementById("popup").style.display = "block";
    }

    function hidePopup() {
      document.getElementById("popup").style.display = "none";
    }

    function submitForm() {
      const name = document.getElementById("name").value;
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;

      const formData = new URLSearchParams();
      formData.append("action", mode);
      formData.append("name", name);
      formData.append("email", email);
      formData.append("password", password);

      fetch(scriptURL, {
        method: "POST",
        body: formData
      })
      .then(res => res.text())
      .then(data => {
        if (data === "INVALID") {
          alert("Login failed. Check your email and password.");
        } else if (data === "EXISTS") {
          alert("Email already registered.");
        } else if (data === "SUCCESS") {
          alert("Signup successful! Please login.");
          hidePopup();
        } else {
          // Logged in successfully, display welcome
          document.getElementById("welcomeMessage").innerText = "Welcome, " + data + "!";
          hidePopup();
        }
      })
      .catch(err => {
        alert("Error: " + err);
      });
    }
  </script>
</body>
</html>
