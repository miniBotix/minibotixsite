
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Products ¬∑ MiniBotix</title>
<link rel="icon" href="file.svg" type="image/svg+xml">
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;500;600;700;800&family=DM+Mono:wght@300;400;500&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#030912;--bg1:#060e1c;--bg2:#0a1628;--bg3:#0d1e35;
  --line:rgba(0,160,255,0.08);--line-hi:rgba(0,180,255,0.2);
  --c:#00b4ff;--c2:#0052cc;--cg:#00ffa3;--co:#ff8c42;--cr:#ff4060;
  --cp:#b06fff;--cy:#ffe066;
  --txt:#daeeff;--txt2:#6b8fa8;
  --glow:0 0 40px rgba(0,160,255,0.14);
}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html{scroll-behavior:smooth}
body{font-family:'DM Sans',system-ui,sans-serif;background:var(--bg);color:var(--txt);overflow-x:hidden;line-height:1.6}
a{color:inherit;text-decoration:none}
::selection{background:rgba(0,180,255,0.25)}
::-webkit-scrollbar{width:3px}::-webkit-scrollbar-track{background:var(--bg)}
::-webkit-scrollbar-thumb{background:var(--line-hi);border-radius:2px}

/* BG */
#rain{position:fixed;inset:0;z-index:0;pointer-events:none}
.gbg{position:fixed;inset:0;z-index:1;pointer-events:none;
  background-image:linear-gradient(var(--line)1px,transparent 1px),linear-gradient(90deg,var(--line)1px,transparent 1px);
  background-size:48px 48px;
  mask-image:radial-gradient(ellipse 90% 70% at 50% 0%,black 20%,transparent 100%)}
.rglow{position:fixed;top:-20%;left:50%;transform:translateX(-50%);width:1000px;height:700px;
  background:radial-gradient(ellipse at center,rgba(0,70,200,0.16)0%,transparent 70%);z-index:1;pointer-events:none}
header,main,footer,section,.page{position:relative;z-index:10}

/* NAVBAR */
header{position:fixed;top:0;left:0;right:0;height:62px;z-index:200;
  display:flex;align-items:center;justify-content:space-between;padding:0 28px;
  background:rgba(3,9,18,0.9);backdrop-filter:blur(18px) saturate(1.6);
  border-bottom:1px solid var(--line);transition:box-shadow .3s}
header.scrolled{box-shadow:0 4px 50px rgba(0,0,0,.7)}
.brand{display:flex;align-items:center;gap:11px;cursor:pointer;user-select:none}
.bm{width:34px;height:34px;border-radius:8px;background:linear-gradient(135deg,var(--c2),var(--c));
  display:flex;align-items:center;justify-content:center;
  font-family:'Syne',sans-serif;font-weight:800;font-size:15px;color:#fff;
  box-shadow:0 4px 18px rgba(0,120,255,0.4);flex-shrink:0}
.bn{font-family:'Syne',sans-serif;font-weight:700;font-size:17px;letter-spacing:-.01em}
.bn em{color:var(--c);font-style:normal}

nav.main-nav{display:flex;gap:1px}
nav.main-nav a{font-size:11.5px;font-weight:500;letter-spacing:.05em;text-transform:uppercase;
  color:var(--txt2);padding:6px 10px;border-radius:6px;transition:color .2s,background .2s;position:relative}
nav.main-nav a::after{content:'';position:absolute;bottom:2px;left:50%;transform:translateX(-50%);
  width:0;height:1.5px;background:var(--c);border-radius:1px;transition:width .25s}
nav.main-nav a:hover{color:var(--c);background:rgba(0,180,255,0.05)}
nav.main-nav a:hover::after{width:55%}
nav.main-nav a.active{color:var(--c)}
nav.main-nav a.active::after{width:55%}

.nr{display:flex;align-items:center;gap:12px}
.cpill{display:flex;align-items:center;gap:7px;background:var(--bg2);border:1px solid var(--line-hi);
  border-radius:999px;padding:5px 12px;cursor:default;user-select:none}
.pulse{width:6px;height:6px;border-radius:50%;background:var(--cg);flex-shrink:0;animation:blink 2s infinite}
@keyframes blink{0%,100%{opacity:1;box-shadow:0 0 7px var(--cg)}50%{opacity:.25;box-shadow:none}}
.csw{width:22px;height:22px;flex-shrink:0}
#navClock{font-family:'DM Mono',monospace;font-size:11px;font-weight:500;color:var(--cg)}
.btn-o{background:transparent;border:1px solid var(--line-hi);padding:7px 14px;border-radius:7px;
  color:var(--txt2);font-family:'DM Sans',sans-serif;font-size:12px;font-weight:600;letter-spacing:.04em;cursor:pointer;transition:all .2s}
.btn-o:hover{border-color:var(--c);color:var(--c);background:rgba(0,180,255,0.05)}
.btn-s{background:linear-gradient(135deg,var(--c2),var(--c));border:none;padding:8px 16px;border-radius:7px;
  color:#fff;font-family:'DM Sans',sans-serif;font-size:12px;font-weight:700;letter-spacing:.04em;
  cursor:pointer;box-shadow:0 4px 18px rgba(0,100,255,0.35);transition:opacity .2s,transform .15s}
.btn-s:hover{opacity:.88;transform:translateY(-1px)}
.ham{display:none;width:40px;height:40px;border:1px solid var(--line);border-radius:7px;
  background:transparent;cursor:pointer;flex-direction:column;align-items:center;justify-content:center;gap:5px}
.ham span{width:18px;height:1.5px;background:var(--txt2);border-radius:1px;display:block}
#sui{display:none}
.apill{display:flex;align-items:center;gap:8px;padding:5px 12px 5px 5px;background:var(--bg2);
  border:1px solid var(--line-hi);border-radius:999px;cursor:pointer;transition:background .2s}
.apill:hover{background:var(--bg3)}
.apill img{width:26px;height:26px;border-radius:50%;object-fit:cover}
.apill .aname{font-size:12px;font-weight:600}
.apill .gear{color:var(--txt2);font-size:13px;margin-left:3px}

/* CART BUBBLE */
.cart-wrap{position:relative}
.cart-badge{position:absolute;top:-6px;right:-6px;width:17px;height:17px;border-radius:50%;
  background:var(--cr);color:#fff;font-size:9px;font-weight:700;
  display:none;align-items:center;justify-content:center;font-family:'DM Mono',monospace;
  border:1.5px solid var(--bg)}
.cart-wrap.has-items .cart-badge{display:flex}
.btn-cart{display:flex;align-items:center;gap:7px;background:var(--bg2);border:1px solid var(--line-hi);
  border-radius:7px;padding:7px 12px;cursor:pointer;transition:all .2s;font-size:12px;font-weight:600;color:var(--txt2)}
.btn-cart:hover{border-color:var(--c);color:var(--c);background:rgba(0,180,255,0.05)}

#mobileNav{display:none;flex-direction:column;gap:2px;position:fixed;top:62px;left:0;right:0;
  background:rgba(4,10,20,0.98);backdrop-filter:blur(16px);
  border-bottom:1px solid var(--line);padding:12px 16px 20px;z-index:190}
#mobileNav.open{display:flex}
#mobileNav a{padding:11px 12px;border-radius:7px;font-size:13px;font-weight:500;
  color:var(--txt2);border-left:2px solid transparent;transition:all .2s}
#mobileNav a:hover{background:var(--bg2);color:var(--c);border-left-color:var(--c)}

/* PAGE HERO */
.page-hero{padding:120px 28px 72px;text-align:center}
.page-hero .con{max-width:700px;margin:0 auto}
.htag{display:inline-flex;align-items:center;gap:8px;border:1px solid var(--line-hi);border-radius:4px;
  padding:5px 12px;margin-bottom:28px;font-family:'DM Mono',monospace;font-size:10px;
  letter-spacing:.12em;text-transform:uppercase;color:var(--c);background:rgba(0,180,255,0.04)}
.htag .hd{width:5px;height:5px;border-radius:50%;background:var(--cg);animation:blink 1.8s infinite}
.page-hero h1{font-family:'Syne',sans-serif;font-weight:800;font-size:clamp(38px,5vw,64px);
  letter-spacing:-.03em;line-height:1.05;margin-bottom:20px}
.page-hero h1 .acc{background:linear-gradient(90deg,var(--c),var(--cg));
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.page-hero p{color:var(--txt2);font-size:16px;line-height:1.72;max-width:560px;margin:0 auto 28px}
.hero-actions{display:flex;gap:12px;justify-content:center;flex-wrap:wrap;margin-bottom:32px}

/* SEARCH + SORT */
.filter-row{display:flex;gap:8px;flex-wrap:wrap;justify-content:center;max-width:700px;margin:0 auto}
.search-input{flex:1;min-width:200px;padding:11px 16px;background:var(--bg2);border:1px solid var(--line-hi);
  border-radius:8px;color:var(--txt);font-family:'DM Sans',sans-serif;font-size:14px;outline:none;transition:border-color .2s,box-shadow .2s}
.search-input::placeholder{color:var(--txt2)}
.search-input:focus{border-color:var(--c);box-shadow:0 0 0 3px rgba(0,180,255,0.08)}
.sort-select{padding:11px 14px;background:var(--bg2);border:1px solid var(--line-hi);
  border-radius:8px;color:var(--txt);font-family:'DM Mono',monospace;font-size:11px;
  outline:none;cursor:pointer;transition:border-color .2s;appearance:none;-webkit-appearance:none;
  background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6' viewBox='0 0 10 6'%3E%3Cpath d='M0 0l5 6 5-6z' fill='%236b8fa8'/%3E%3C/svg%3E");
  background-repeat:no-repeat;background-position:right 12px center;padding-right:32px}
.sort-select:focus{border-color:var(--c)}

/* SEP */
.sep{height:1px;background:linear-gradient(90deg,transparent,var(--line-hi),transparent)}

/* SECTION */
.section{padding:80px 28px}
.con{max-width:1140px;margin:0 auto}
.sl2{display:inline-flex;align-items:center;gap:7px;
  font-family:'DM Mono',monospace;font-size:9px;letter-spacing:.14em;text-transform:uppercase;
  color:var(--c);border:1px solid var(--line-hi);padding:4px 10px;border-radius:3px;
  background:rgba(0,180,255,0.04);margin-bottom:16px}
.sn{color:var(--txt2)}
h2.sh{font-family:'Syne',sans-serif;font-weight:800;font-size:clamp(26px,3.2vw,40px);
  letter-spacing:-.02em;margin-bottom:12px}
.lead{color:var(--txt2);font-size:15px;line-height:1.72;max-width:560px;margin-bottom:44px}

/* PRODUCTS GRID */
.products-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(290px,1fr));gap:20px}

/* PRODUCT CARD */
.prod-card{
  background:var(--bg2);border:1px solid var(--line);border-radius:14px;
  overflow:hidden;transition:transform .3s,border-color .3s,box-shadow .3s;
  position:relative;display:flex;flex-direction:column;
}
.prod-card:hover{transform:translateY(-6px);border-color:var(--line-hi);box-shadow:var(--glow)}
.prod-card::before{
  content:'';position:absolute;top:0;left:0;right:0;height:2px;
  background:linear-gradient(90deg,var(--c2),var(--c));
  transform:scaleX(0);transform-origin:left;
  transition:transform .35s cubic-bezier(.4,0,.2,1);z-index:2;
}
.prod-card:hover::before{transform:scaleX(1)}

.pc-thumb{height:180px;background:var(--bg1);display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative}
.pc-thumb img{max-width:100%;max-height:100%;object-fit:contain;transition:transform .4s}
.prod-card:hover .pc-thumb img{transform:scale(1.05)}
.pc-thumb .pc-placeholder{font-size:52px;opacity:.3}

.pc-cat{position:absolute;top:12px;left:12px;z-index:3;
  font-family:'DM Mono',monospace;font-size:8px;letter-spacing:.1em;text-transform:uppercase;
  padding:4px 8px;border-radius:3px;background:rgba(0,0,0,0.65);border:1px solid var(--line-hi);
  color:var(--txt2);backdrop-filter:blur(4px)}

.pc-body{padding:20px 22px;flex:1;display:flex;flex-direction:column;gap:6px}
.pc-name{font-family:'Syne',sans-serif;font-weight:700;font-size:17px}
.pc-desc{font-size:13px;color:var(--txt2);line-height:1.65;flex:1}
.pc-price{font-family:'Syne',sans-serif;font-weight:800;font-size:22px;color:var(--c);margin-top:4px}
.pc-price span{font-size:13px;font-weight:400;color:var(--txt2);font-family:'DM Sans',sans-serif}

.pc-actions{display:flex;gap:8px;padding:16px 22px;border-top:1px solid var(--line);background:rgba(0,0,0,0.15)}
.btn-details{flex:1;padding:9px 14px;background:transparent;border:1px solid var(--line-hi);
  border-radius:7px;color:var(--txt2);font-family:'DM Sans',sans-serif;font-size:12px;font-weight:600;
  letter-spacing:.04em;cursor:pointer;transition:all .2s;text-align:center}
.btn-details:hover{border-color:var(--c);color:var(--c);background:rgba(0,180,255,0.05)}
.btn-cart-add{flex:1;padding:9px 14px;background:linear-gradient(135deg,var(--c2),var(--c));
  border:none;border-radius:7px;color:#fff;font-family:'DM Sans',sans-serif;font-size:12px;
  font-weight:700;letter-spacing:.04em;cursor:pointer;
  box-shadow:0 4px 14px rgba(0,100,255,0.25);transition:opacity .2s,transform .15s;
  display:flex;align-items:center;justify-content:center;gap:6px}
.btn-cart-add:hover{opacity:.88;transform:translateY(-1px)}
.btn-cart-add.added{background:linear-gradient(135deg,#006644,var(--cg));color:#010e07;box-shadow:0 4px 14px rgba(0,255,163,0.2)}

/* EMPTY STATE */
.empty-state{text-align:center;padding:64px 28px;color:var(--txt2)}
.empty-state .ei{font-size:52px;margin-bottom:16px;opacity:.4}

/* ORDERS SECTION */
.order-row{background:var(--bg2);border:1px solid var(--line);border-radius:10px;
  padding:20px 22px;margin-bottom:12px;transition:border-color .2s}
.order-row:hover{border-color:var(--line-hi)}
.order-meta{display:flex;justify-content:space-between;align-items:flex-start;gap:16px;flex-wrap:wrap}
.order-id{font-family:'DM Mono',monospace;font-size:10px;letter-spacing:.1em;color:var(--c);
  text-transform:uppercase;margin-bottom:4px}
.order-date{font-size:12px;color:var(--txt2)}
.order-total{font-family:'Syne',sans-serif;font-weight:700;font-size:20px;color:var(--c)}
.order-status{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:.1em;text-transform:uppercase;
  padding:3px 8px;border-radius:3px;border:1px solid rgba(0,255,163,0.25);
  color:var(--cg);background:rgba(0,255,163,0.05)}
.order-items{margin-top:12px;padding-top:12px;border-top:1px solid var(--line)}
.order-item{font-size:13px;color:var(--txt2);padding:4px 0;display:flex;justify-content:space-between}

/* MODALS */
.modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;
  background:rgba(0,0,0,0.78);z-index:500;backdrop-filter:blur(9px)}
.modal.open{display:flex}
.mc{width:100%;max-width:560px;background:var(--bg2);border:1px solid var(--line-hi);
  border-radius:14px;overflow:hidden;animation:sUp .3s ease;max-height:90vh;display:flex;flex-direction:column}
@keyframes sUp{from{opacity:0;transform:translateY(24px)}to{opacity:1;transform:translateY(0)}}
.mc-head{display:flex;align-items:center;justify-content:space-between;
  padding:20px 24px;border-bottom:1px solid var(--line);flex-shrink:0}
.mc-head h3{font-family:'Syne',sans-serif;font-weight:700;font-size:18px}
.mcc{color:var(--txt2);font-size:22px;cursor:pointer;line-height:1;transition:color .2s;background:none;border:none}
.mcc:hover{color:#fff}
.mc-body{padding:24px;overflow-y:auto;flex:1}
.mc-foot{display:flex;gap:10px;padding:16px 24px;border-top:1px solid var(--line);background:rgba(0,0,0,0.15);flex-shrink:0}

/* CART ITEMS */
.cart-item{display:flex;gap:14px;align-items:center;padding:14px 0;border-bottom:1px solid var(--line)}
.cart-item:last-child{border-bottom:none}
.ci-img{width:52px;height:52px;border-radius:8px;background:var(--bg1);display:flex;align-items:center;justify-content:center;flex-shrink:0;overflow:hidden}
.ci-img img{max-width:100%;max-height:100%;object-fit:contain}
.ci-info{flex:1}
.ci-name{font-family:'Syne',sans-serif;font-weight:600;font-size:14px;margin-bottom:3px}
.ci-price{font-size:12px;color:var(--txt2);font-family:'DM Mono',monospace}
.ci-qty{display:flex;align-items:center;gap:8px;flex-shrink:0}
.qty-btn{width:26px;height:26px;border-radius:5px;border:1px solid var(--line-hi);background:transparent;
  color:var(--txt);cursor:pointer;transition:all .2s;font-size:14px;display:flex;align-items:center;justify-content:center}
.qty-btn:hover{border-color:var(--c);color:var(--c)}
.qty-val{font-family:'DM Mono',monospace;font-size:12px;min-width:20px;text-align:center}
.ci-remove{color:var(--txt2);cursor:pointer;font-size:13px;transition:color .2s;background:none;border:none;padding:4px}
.ci-remove:hover{color:var(--cr)}

.cart-total-row{display:flex;justify-content:space-between;align-items:center;
  padding:16px 0 0;border-top:1px solid var(--line);margin-top:8px}
.ct-label{font-size:13px;color:var(--txt2)}
.ct-val{font-family:'Syne',sans-serif;font-weight:800;font-size:24px;color:var(--c)}

/* DELIVERY FIELD */
.fg{margin-bottom:14px}
.fg label{display:block;font-family:'DM Mono',monospace;font-size:10px;letter-spacing:.08em;
  text-transform:uppercase;color:var(--txt2);margin-bottom:6px}
.fg input,.fg textarea{width:100%;padding:11px 14px;background:var(--bg1);border:1px solid var(--line-hi);
  border-radius:7px;color:var(--txt);font-family:'DM Sans',sans-serif;font-size:13px;outline:none;
  transition:border-color .2s,box-shadow .2s;resize:vertical}
.fg input:focus,.fg textarea:focus{border-color:var(--c);box-shadow:0 0 0 3px rgba(0,180,255,0.08)}

/* AUTH MODAL */
.tabs{display:flex;gap:4px;background:var(--bg1);border-radius:8px;padding:4px;margin-bottom:20px}
.tab{flex:1;padding:8px;border-radius:6px;border:none;background:transparent;color:var(--txt2);
  font-family:'DM Sans',sans-serif;font-size:12px;font-weight:600;cursor:pointer;transition:all .2s}
.tab.on{background:linear-gradient(135deg,var(--c2),var(--c));color:#fff;box-shadow:0 2px 14px rgba(0,100,255,0.3)}
.ma{display:flex;gap:10px;margin-top:20px}
.ma .btn-s{flex:1;padding:11px}
.ma .btn-o{padding:11px 16px;font-size:13px}
.mnote{font-size:11px;color:var(--txt2);margin-top:12px}

/* DETAILS MODAL THUMB */
.det-thumb{width:100%;height:220px;background:var(--bg1);border-radius:10px;
  display:flex;align-items:center;justify-content:center;overflow:hidden;margin-bottom:20px}
.det-thumb img{max-width:100%;max-height:100%;object-fit:contain}
.det-price{font-family:'Syne',sans-serif;font-weight:800;font-size:28px;color:var(--c);margin-bottom:12px}
.det-desc{font-size:14px;color:var(--txt2);line-height:1.72;margin-bottom:20px}
.det-cat{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:.1em;text-transform:uppercase;
  padding:4px 10px;border-radius:3px;border:1px solid var(--line-hi);color:var(--txt2);
  display:inline-block;margin-bottom:16px}

/* TOAST */
.toast{position:fixed;bottom:28px;left:50%;transform:translateX(-50%);padding:11px 18px;
  border-radius:8px;font-size:13px;font-weight:500;z-index:9999;box-shadow:0 8px 30px rgba(0,0,0,.5);
  animation:toastIn .3s ease}
@keyframes toastIn{from{opacity:0;transform:translateX(-50%) translateY(10px)}to{opacity:1;transform:translateX(-50%) translateY(0)}}

/* FOOTER */
footer{padding:26px 28px;border-top:1px solid var(--line);
  display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:16px}
.finfo{font-family:'DM Mono',monospace;font-size:11px;color:var(--txt2)}
.flinks{display:flex;gap:18px;font-size:12px;color:var(--txt2)}
.flinks a:hover{color:var(--c)}

/* REVEAL */
.reveal{opacity:0;transform:translateY(30px);transition:opacity .75s ease,transform .75s ease}
.reveal.in{opacity:1;transform:translateY(0)}
.d1{transition-delay:.1s}.d2{transition-delay:.18s}.d3{transition-delay:.26s}
.d4{transition-delay:.34s}.d5{transition-delay:.42s}

/* RESPONSIVE */
@media(max-width:1020px){nav.main-nav{display:none}.ham{display:flex}}
@media(max-width:640px){header{padding:0 16px}.section{padding:56px 16px}.page-hero{padding:100px 16px 56px}.products-grid{grid-template-columns:1fr}.filter-row{flex-direction:column}.hero-actions{flex-direction:column;align-items:center}footer{flex-direction:column;align-items:flex-start}}
</style>
</head>
<body>

<canvas id="rain"></canvas>
<div class="gbg"></div>
<div class="rglow"></div>

<!-- NAVBAR -->
<header id="hdr">
  <div class="brand" onclick="location.href='index.html'">
    <div class="bm">M</div>
    <div class="bn">Mini<em>Botix</em></div>
  </div>

  <nav class="main-nav">
    <a href="index.html">Home</a>
    <a href="courses.html">Courses</a>
    <a href="products.html" class="active">Products</a>
    <a href="componentshop.html">Components</a>
    <a href="projects.html">Projects</a>
    <a href="apps.html">Apps</a>
    <a href="about_us.html">About</a>
    <a href="index.html#contact">Contact</a>
  </nav>

  <div class="nr">
    <div class="cpill">
      <div class="pulse"></div>
      <div class="csw">
        <svg viewBox="0 0 44 44" fill="none">
          <circle cx="22" cy="22" r="19" stroke="rgba(0,180,255,0.18)" stroke-width="1.5"/>
          <circle cx="22" cy="22" r="1.5" fill="var(--cg)"/>
          <line id="nh" x1="22" y1="22" x2="22" y2="12" stroke="var(--txt)" stroke-width="2" stroke-linecap="round"/>
          <line id="nm" x1="22" y1="22" x2="22" y2="9"  stroke="var(--c)"  stroke-width="1.2" stroke-linecap="round"/>
          <line id="ns" x1="22" y1="22" x2="22" y2="6"  stroke="var(--cg)" stroke-width="0.8" stroke-linecap="round"/>
        </svg>
      </div>
      <span id="navClock">00:00:00</span>
    </div>

    <!-- Cart (shown when signed in) -->
    <div id="cartWrap" class="cart-wrap" style="display:none">
      <button class="btn-cart" id="openCart">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M7 18c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm10 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-14.8-16h-2.2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96C4 16.1 5.1 17 6.45 17H19v-2H6.83c-.17 0-.3-.13-.3-.3l.03-.12.9-1.58H17c.75 0 1.41-.41 1.75-1.03l3.58-6.49A1 1 0 0 0 21.46 4H5.21l-.94-2z"/></svg>
        Cart
      </button>
      <div class="cart-badge" id="cartBadge">0</div>
    </div>

    <div id="sou"><button class="btn-o" id="openAuth">Sign In</button></div>
    <div id="sui">
      <div class="apill" id="openPS">
        <img id="pAvatar" src="file.svg" alt="">
        <span class="aname" id="pName">User</span>
        <span class="gear">‚öô</span>
      </div>
    </div>
    <button class="ham" id="hamBtn" aria-label="Menu"><span></span><span></span><span></span></button>
  </div>
</header>

<div id="mobileNav">
  <a href="index.html" onclick="closeM()">Home</a>
  <a href="courses.html" onclick="closeM()">Courses</a>
  <a href="products.html" onclick="closeM()">Products</a>
  <a href="componentshop.html" onclick="closeM()">Components</a>
  <a href="projects.html" onclick="closeM()">Projects</a>
  <a href="apps.html" onclick="closeM()">Apps</a>
  <a href="about_us.html" onclick="closeM()">About</a>
  <a href="index.html#contact" onclick="closeM()">Contact</a>
</div>

<!-- PAGE HERO -->
<div class="page-hero reveal">
  <div class="con">
    <div class="htag"><span class="hd"></span> MiniBotix ¬∑ Quality Goods</div>
    <h1>Reliable<br><span class="acc">Products</span></h1>
    <p>Browse our curated selection of electronics, kits, and components. Add to cart and place an order ‚Äî we deliver and support you every step of the way.</p>
    <div class="hero-actions">
      <button class="btn-s" style="padding:11px 24px;font-size:13px" id="toProductsBtn">Shop Products ‚Üí</button>
      <button class="btn-o" style="padding:11px 24px;font-size:13px" onclick="location.href='index.html#contact'">Contact Support</button>
    </div>
    <div class="filter-row">
      <input id="searchInput" class="search-input" placeholder="Search products by name, description‚Ä¶">
      <select id="sortSelect" class="sort-select">
        <option value="relevance">Sort: Relevance</option>
        <option value="price_asc">Price: Low ‚Üí High</option>
        <option value="price_desc">Price: High ‚Üí Low</option>
        <option value="name_asc">Name: A ‚Üí Z</option>
        <option value="name_desc">Name: Z ‚Üí A</option>
      </select>
      <button class="btn-o" id="clearBtn">Clear</button>
    </div>
  </div>
</div>

<div class="sep"></div>

<!-- PRODUCTS -->
<section class="section" id="productsSection">
  <div class="con">
    <div class="reveal">
      <div class="sl2"><span class="sn">01 /</span> Products</div>
      <h2 class="sh">Available Products</h2>
      <p class="lead">Click "Add to Cart" to collect items. Place your order when ready ‚Äî your cart syncs to your account when signed in.</p>
    </div>
    <div class="products-grid reveal d2" id="productsGrid"></div>
  </div>
</section>

<div class="sep"></div>

<!-- ORDERS -->
<section class="section" id="ordersSection">
  <div class="con">
    <div class="reveal">
      <div class="sl2"><span class="sn">02 /</span> Orders</div>
      <h2 class="sh">Your Orders</h2>
      <p class="lead" id="ordersLead">Sign in to view your order history.</p>
    </div>
    <div id="ordersList" class="reveal d2"></div>
  </div>
</section>

<!-- FOOTER -->
<footer>
  <div style="display:flex;align-items:center;gap:10px">
    <div class="bm" style="width:28px;height:28px;font-size:12px;border-radius:6px">M</div>
    <div class="finfo">¬© 2025 MiniBotix ¬∑ Learn ¬∑ Build ¬∑ Innovate</div>
  </div>
  <div class="flinks">
    <a href="index.html">Home</a>
    <a href="courses.html">Courses</a>
    <a href="products.html">Products</a>
    <a href="projects.html">Projects</a>
    <a href="index.html#contact">Contact</a>
  </div>
</footer>

<!-- CART MODAL -->
<div id="cartModal" class="modal">
  <div class="mc" style="max-width:620px">
    <div class="mc-head">
      <h3>Your Cart</h3>
      <button class="mcc" id="cartClose">√ó</button>
    </div>
    <div class="mc-body" id="cartBody">
      <div class="empty-state"><div class="ei">üõí</div><p>Your cart is empty.</p></div>
    </div>
    <div class="mc-foot" style="flex-direction:column;gap:12px">
      <div class="fg" style="margin:0">
        <label>Delivery Address</label>
        <input id="deliveryAddress" type="text" placeholder="Full address, area, city, PIN‚Ä¶">
      </div>
      <div style="display:flex;gap:10px">
        <button class="btn-o" id="cartClose2" style="flex:0 0 auto;padding:11px 18px">‚Üê Back</button>
        <button class="btn-s" id="placeOrderBtn" style="flex:1;padding:11px">Place Order ‚Üí</button>
      </div>
    </div>
  </div>
</div>

<!-- DETAILS MODAL -->
<div id="detailsModal" class="modal">
  <div class="mc">
    <div class="mc-head">
      <h3 id="detTitle">Product</h3>
      <button class="mcc" id="detClose">√ó</button>
    </div>
    <div class="mc-body">
      <div class="det-thumb"><img id="detImg" src="" alt=""></div>
      <div class="det-cat" id="detCat"></div>
      <div class="det-price" id="detPrice"></div>
      <div class="det-desc" id="detDesc"></div>
    </div>
    <div class="mc-foot">
      <button class="btn-o" id="detClose2" style="padding:11px 18px">‚Üê Back</button>
      <button class="btn-s" id="detAddCart" style="flex:1;padding:11px">Add to Cart</button>
    </div>
  </div>
</div>

<!-- AUTH MODAL -->
<div id="authModal" class="modal">
  <div class="mc" style="max-width:420px">
    <div class="mc-head"><h3>Access MiniBotix</h3><button class="mcc" id="authClose">√ó</button></div>
    <div class="mc-body">
      <div class="tabs">
        <button class="tab on" id="tabEmail">Email</button>
        <button class="tab" id="tabGoogle">Google</button>
      </div>
      <div id="emailView">
        <div id="loginView">
          <div class="fg"><label>Email</label><input id="loginEmail" type="email" placeholder="you@domain.com"></div>
          <div class="fg"><label>Password</label><input id="loginPassword" type="password" placeholder="Password"></div>
          <div class="ma"><button class="btn-s" id="emailSignIn">Sign In</button><button class="btn-o" id="showRegister">Register</button></div>
        </div>
        <div id="registerView" style="display:none">
          <div class="fg"><label>Full Name</label><input id="regName" type="text" placeholder="Your name"></div>
          <div class="fg"><label>Phone</label><input id="regPhone" type="tel" placeholder="+91 9XXXXXXXXX"></div>
          <div class="fg"><label>Email</label><input id="regEmail" type="email" placeholder="you@domain.com"></div>
          <div class="fg"><label>Password</label><input id="regPass" type="password" placeholder="Min 6 characters"></div>
          <div class="fg"><label>Confirm</label><input id="regPass2" type="password" placeholder="Confirm password"></div>
          <div class="ma"><button class="btn-s" id="createAccount">Create Account</button><button class="btn-o" id="showLogin">Sign In</button></div>
        </div>
      </div>
      <div id="googleView" style="display:none;padding-top:8px">
        <button id="googleSignIn" class="btn-s" style="width:100%;padding:13px;font-size:14px;display:flex;align-items:center;justify-content:center;gap:10px">
          <svg width="16" height="16" viewBox="0 0 48 48"><path fill="#FFC107" d="M43.6 20.1H42V20H24v8h11.3C33.6 32.7 29.2 36 24 36c-6.6 0-12-5.4-12-12s5.4-12 12-12c3.1 0 5.9 1.1 8 3l5.7-5.7C34.5 6.5 29.5 4 24 4 12.9 4 4 12.9 4 24s8.9 20 20 20 20-8.9 20-20c0-1.3-.1-2.6-.4-3.9z"/><path fill="#FF3D00" d="M6.3 14.7l6.6 4.8C14.6 16.1 19 13 24 13c3.1 0 5.9 1.1 8 3l5.7-5.7C34.5 6.5 29.5 4 24 4 16.3 4 9.7 8.3 6.3 14.7z"/><path fill="#4CAF50" d="M24 44c5.2 0 9.9-2 13.4-5.2l-6.2-5.2C29.2 35.3 26.7 36 24 36c-5.2 0-9.5-3.3-11.2-7.9L6.1 33.4C9.5 39.6 16.2 44 24 44z"/><path fill="#1976D2" d="M43.6 20.1H42V20H24v8h11.3c-.8 2.3-2.3 4.2-4.3 5.6l6.2 5.2C42.3 35.5 44 30.1 44 24c0-1.3-.1-2.6-.4-3.9z"/></svg>
          Continue with Google
        </button>
      </div>
      <p class="mnote">Your data is stored securely in Firestore.</p>
    </div>
  </div>
</div>

<!-- PROFILE MODAL -->
<div id="profileModal" class="modal">
  <div class="mc" style="max-width:420px">
    <div class="mc-head"><h3>Profile Settings</h3><button class="mcc" id="profileClose">√ó</button></div>
    <div class="mc-body">
      <div class="fg"><label>Name</label><input id="pfName" type="text"></div>
      <div class="fg"><label>Phone</label><input id="pfPhone" type="tel"></div>
      <div class="fg"><label>Delivery Area</label><input id="pfArea" type="text"></div>
      <div class="ma"><button class="btn-s" id="saveProfile">Save Changes</button><button class="btn-o" id="logoutBtn">Logout</button></div>
    </div>
  </div>
</div>

<script>
/* RAIN */
(function(){
  const cv=document.getElementById('rain'),ctx=cv.getContext('2d');
  let W,H,dr=[];
  function rs(){W=cv.width=innerWidth;H=cv.height=innerHeight;init()}
  function init(){dr=[];for(let i=0;i<180;i++){dr.push({x:Math.random()*W,y:Math.random()*H-H,len:Math.random()*35+10,sp:Math.random()*3.5+2,sw:Math.random()*1.2+0.3,a:0.04+Math.random()*0.09,drift:Math.random()*0.5-0.25,ph:Math.random()*Math.PI*2})}}
  function draw(){
    ctx.clearRect(0,0,W,H);
    dr.forEach(d=>{
      const g=ctx.createLinearGradient(d.x,d.y,d.x+d.drift*8,d.y+d.len);
      g.addColorStop(0,'rgba(0,180,255,0)');g.addColorStop(0.5,`rgba(0,190,255,${d.a})`);g.addColorStop(1,'rgba(100,220,255,0)');
      ctx.beginPath();ctx.strokeStyle=g;ctx.lineWidth=d.sw;
      ctx.moveTo(d.x,d.y);ctx.lineTo(d.x+d.drift*4,d.y+d.len);ctx.stroke();
      d.y+=d.sp;d.x+=Math.sin(d.y*0.012+d.ph)*0.4;
      if(d.y>H+50){d.y=-50;d.x=Math.random()*W}
      d.a=0.04+Math.random()*0.08;
    });
    requestAnimationFrame(draw);
  }
  window.addEventListener('resize',rs);rs();draw();
})();

/* CLOCK */
function rpt(cx,cy,ang,len){return{x:cx+Math.sin(ang)*len,y:cy-Math.cos(ang)*len}}
function setHand(id,ang,cx,cy,len){const el=document.getElementById(id);if(!el)return;const p=rpt(cx,cy,ang,len);el.setAttribute('x2',p.x.toFixed(2));el.setAttribute('y2',p.y.toFixed(2))}
function updateClock(){
  const n=new Date(),h=n.getHours(),m=n.getMinutes(),s=n.getSeconds(),ms=n.getMilliseconds();
  const sa=(s+ms/1000)*(Math.PI*2/60),ma=(m+s/60)*(Math.PI*2/60),ha=(h%12+m/60)*(Math.PI*2/12);
  setHand('nh',ha,22,22,10);setHand('nm',ma,22,22,13);setHand('ns',sa,22,22,15);
  const pad=v=>String(v).padStart(2,'0');
  document.getElementById('navClock').textContent=`${pad(h)}:${pad(m)}:${pad(s)}`;
}
setInterval(updateClock,80);updateClock();

/* SCROLL */
window.addEventListener('scroll',()=>document.getElementById('hdr').classList.toggle('scrolled',scrollY>40));
const io=new IntersectionObserver(en=>{en.forEach(e=>{if(e.isIntersecting){e.target.classList.add('in');io.unobserve(e.target)}})},{threshold:0.08});
document.querySelectorAll('.reveal').forEach(el=>io.observe(el));

/* MOBILE NAV */
document.getElementById('hamBtn').addEventListener('click',()=>document.getElementById('mobileNav').classList.toggle('open'));
function closeM(){document.getElementById('mobileNav').classList.remove('open')}

/* TOAST */
function toast(msg,err){
  const t=document.createElement('div');t.className='toast';t.textContent=msg;
  t.style.background=err?'var(--cr)':'var(--cg)';t.style.color=err?'#fff':'#010e07';
  document.body.appendChild(t);
  setTimeout(()=>{t.style.transition='all .4s';t.style.opacity='0';t.style.transform='translateX(-50%) translateY(10px)'},2400);
  setTimeout(()=>t.remove(),2800);
}

/* ESCAPE */
function esc(s){return String(s||'').replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;')}

/* MODALS */
const AM=document.getElementById('authModal'),PM=document.getElementById('profileModal');
const CM=document.getElementById('cartModal'),DM=document.getElementById('detailsModal');

document.getElementById('openAuth').addEventListener('click',()=>AM.classList.add('open'));
document.getElementById('authClose').addEventListener('click',()=>AM.classList.remove('open'));
document.getElementById('profileClose').addEventListener('click',()=>PM.classList.remove('open'));
document.getElementById('openPS').addEventListener('click',()=>PM.classList.add('open'));
document.getElementById('openCart').addEventListener('click',()=>{renderCartBody();CM.classList.add('open')});
document.getElementById('cartClose').addEventListener('click',()=>CM.classList.remove('open'));
document.getElementById('cartClose2').addEventListener('click',()=>CM.classList.remove('open'));
document.getElementById('detClose').addEventListener('click',()=>DM.classList.remove('open'));
document.getElementById('detClose2').addEventListener('click',()=>DM.classList.remove('open'));
window.addEventListener('click',e=>{
  [AM,PM,CM,DM].forEach(m=>{if(e.target===m)m.classList.remove('open')});
});

/* AUTH TABS */
const tE=document.getElementById('tabEmail'),tG=document.getElementById('tabGoogle');
const eV=document.getElementById('emailView'),gV=document.getElementById('googleView');
tE.addEventListener('click',()=>{eV.style.display='block';gV.style.display='none';tE.classList.add('on');tG.classList.remove('on')});
tG.addEventListener('click',()=>{eV.style.display='none';gV.style.display='block';tG.classList.add('on');tE.classList.remove('on')});
document.getElementById('showRegister').addEventListener('click',()=>{document.getElementById('loginView').style.display='none';document.getElementById('registerView').style.display='block'});
document.getElementById('showLogin').addEventListener('click',()=>{document.getElementById('registerView').style.display='none';document.getElementById('loginView').style.display='block'});

/* HERO SCROLL */
document.getElementById('toProductsBtn').addEventListener('click',()=>document.getElementById('productsSection').scrollIntoView({behavior:'smooth'}));

/* ===== PRODUCTS STATE ===== */
const APP_SCRIPT_URL='https://script.google.com/macros/s/AKfycbxIakxm6KidTEqlDPIyQ5AG_dDlUjcZf6y8lrQ6AMtf_-nHY8yTrKekd04l2wgWN1EMtA/exec';
const ADMIN_EMAIL='minibotix@gmail.com';
let products=[],filteredProducts=[],cart=[],currentUser=null,detailProduct=null;

/* LOAD PRODUCTS */
async function loadProducts(){
  try{
    const res=await fetch('products.json',{cache:'no-store'});
    if(!res.ok)throw new Error(res.status);
    const raw=await res.json();
    products=(Array.isArray(raw)?raw:[]).map((p,i)=>({
      id:p.id||p.sku||('prod_'+i),
      name:p.name||p.title||'Unnamed',
      price:Number(p.price||0),
      description:p.description||p.desc||'',
      image:p.image||p.img||'',
      category:p.category||p.cat||''
    }));
  }catch(e){
    console.error(e);
    products=[{id:'_err',name:'Unable to load products.json',price:0,description:'Ensure products.json is present and valid.',image:'',category:''}];
  }
  filteredProducts=[...products];
  renderProducts();
}

/* RENDER PRODUCTS */
function renderProducts(){
  const grid=document.getElementById('productsGrid');
  grid.innerHTML='';
  if(!filteredProducts.length){
    grid.innerHTML='<div class="empty-state"><div class="ei">üì¶</div><p>No products found.</p></div>';
    return;
  }
  filteredProducts.forEach(p=>{
    const el=document.createElement('div');
    el.className='prod-card';
    el.innerHTML=`
      ${p.category?`<div class="pc-cat">${esc(p.category)}</div>`:''}
      <div class="pc-thumb">
        ${p.image
          ?`<img src="${esc(p.image)}" alt="${esc(p.name)}" onerror="this.parentNode.innerHTML='<span class=pc-placeholder>üì¶</span>'">`
          :'<span class="pc-placeholder">üì¶</span>'}
      </div>
      <div class="pc-body">
        <div class="pc-name">${esc(p.name)}</div>
        <div class="pc-desc">${esc(p.description)}</div>
        <div class="pc-price">‚Çπ${Number(p.price).toLocaleString()} <span>incl. taxes</span></div>
      </div>
      <div class="pc-actions">
        <button class="btn-details" data-id="${esc(p.id)}">Details</button>
        <button class="btn-cart-add" data-id="${esc(p.id)}">
          <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor"><path d="M11 9h2V6h3V4h-3V1h-2v3H8v2h3v3zm-4 9c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm10 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-14.8-14h-2.2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96C4 17.1 5.1 18 6.45 18H19v-2H6.83c-.17 0-.3-.13-.3-.3l.03-.12.9-1.58H17c.75 0 1.41-.41 1.75-1.03l3.58-6.49A1 1 0 0 0 21.46 5H5.21l-.94-2H2.2z"/></svg>
          Add to Cart
        </button>
      </div>
    `;
    el.querySelector('.btn-details').addEventListener('click',()=>openDetails(p.id));
    el.querySelector('.btn-cart-add').addEventListener('click',function(){addToCart(p.id);this.classList.add('added');this.textContent='‚úì Added';setTimeout(()=>{this.classList.remove('added');this.innerHTML='<svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor"><path d="M11 9h2V6h3V4h-3V1h-2v3H8v2h3v3zm-4 9c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm10 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-14.8-14h-2.2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96C4 17.1 5.1 18 6.45 18H19v-2H6.83c-.17 0-.3-.13-.3-.3l.03-.12.9-1.58H17c.75 0 1.41-.41 1.75-1.03l3.58-6.49A1 1 0 0 0 21.46 5H5.21l-.94-2H2.2z"/></svg> Add to Cart'},1800)});
    grid.appendChild(el);
  });
}

/* DETAILS MODAL */
function openDetails(id){
  const p=products.find(x=>x.id===id);if(!p)return;
  detailProduct=p;
  document.getElementById('detTitle').textContent=p.name;
  document.getElementById('detImg').src=p.image||'';
  document.getElementById('detImg').alt=p.name;
  document.getElementById('detCat').textContent=p.category||'Product';
  document.getElementById('detCat').style.display=p.category?'inline-block':'none';
  document.getElementById('detPrice').textContent='‚Çπ'+Number(p.price).toLocaleString();
  document.getElementById('detDesc').textContent=p.description||'No description available.';
  DM.classList.add('open');
}
document.getElementById('detAddCart').addEventListener('click',()=>{
  if(detailProduct){addToCart(detailProduct.id);DM.classList.remove('open')}
});

/* SEARCH & SORT */
function applyFilter(){
  const q=(document.getElementById('searchInput').value||'').trim().toLowerCase();
  const s=document.getElementById('sortSelect').value;
  filteredProducts=products.filter(p=>!q||(p.name||'').toLowerCase().includes(q)||(p.description||'').toLowerCase().includes(q)||(p.category||'').toLowerCase().includes(q));
  if(s==='price_asc')filteredProducts.sort((a,b)=>a.price-b.price);
  else if(s==='price_desc')filteredProducts.sort((a,b)=>b.price-a.price);
  else if(s==='name_asc')filteredProducts.sort((a,b)=>(a.name||'').localeCompare(b.name||''));
  else if(s==='name_desc')filteredProducts.sort((a,b)=>(b.name||'').localeCompare(a.name||''));
  renderProducts();
}
document.getElementById('searchInput').addEventListener('input',applyFilter);
document.getElementById('sortSelect').addEventListener('change',applyFilter);
document.getElementById('clearBtn').addEventListener('click',()=>{document.getElementById('searchInput').value='';document.getElementById('sortSelect').value='relevance';applyFilter()});

/* CART */
function saveCart(){localStorage.setItem('mb_cart',JSON.stringify(cart));updateCartBadge()}
function loadCart(){try{const r=localStorage.getItem('mb_cart');if(r)cart=JSON.parse(r)}catch(e){cart=[]}updateCartBadge()}
function updateCartBadge(){
  const count=cart.reduce((s,i)=>s+i.qty,0);
  const badge=document.getElementById('cartBadge');
  const wrap=document.getElementById('cartWrap');
  badge.textContent=count;
  wrap.classList.toggle('has-items',count>0);
}
function addToCart(id){
  const p=products.find(x=>x.id===id);if(!p)return;
  const ex=cart.find(c=>c.id===id);
  if(ex)ex.qty++;
  else cart.push({id:p.id,title:p.name,price:p.price,qty:1,img:p.image||''});
  saveCart();
  toast('Added: '+p.name);
  if(currentUser)persistCart();
}
function changeQty(id,delta){
  const it=cart.find(x=>x.id===id);if(!it)return;
  it.qty=Math.max(1,it.qty+delta);saveCart();renderCartBody();if(currentUser)persistCart();
}
function removeFromCart(id){
  cart=cart.filter(x=>x.id!==id);saveCart();renderCartBody();if(currentUser)persistCart();
}

function renderCartBody(){
  const body=document.getElementById('cartBody');
  if(!cart.length){body.innerHTML='<div class="empty-state"><div class="ei">üõí</div><p>Your cart is empty.</p></div>';return}
  let total=0;
  let html='';
  cart.forEach(it=>{
    total+=it.price*it.qty;
    html+=`
      <div class="cart-item">
        <div class="ci-img">${it.img?`<img src="${esc(it.img)}" alt="">`:''}</div>
        <div class="ci-info">
          <div class="ci-name">${esc(it.title)}</div>
          <div class="ci-price">‚Çπ${Number(it.price).toLocaleString()} each</div>
        </div>
        <div class="ci-qty">
          <button class="qty-btn" data-id="${esc(it.id)}" data-d="-1">‚àí</button>
          <span class="qty-val">${it.qty}</span>
          <button class="qty-btn" data-id="${esc(it.id)}" data-d="1">+</button>
          <button class="ci-remove" data-id="${esc(it.id)}" title="Remove">‚úï</button>
        </div>
      </div>`;
  });
  html+=`<div class="cart-total-row"><span class="ct-label">Total</span><span class="ct-val">‚Çπ${total.toLocaleString()}</span></div>`;
  body.innerHTML=html;
  body.querySelectorAll('.qty-btn').forEach(b=>b.addEventListener('click',()=>changeQty(b.dataset.id,parseInt(b.dataset.d))));
  body.querySelectorAll('.ci-remove').forEach(b=>b.addEventListener('click',()=>removeFromCart(b.dataset.id)));
}

/* PLACE ORDER */
document.getElementById('placeOrderBtn').addEventListener('click',placeOrder);
async function placeOrder(){
  if(!currentUser){toast('Please sign in to place an order',true);return}
  if(!cart.length){toast('Cart is empty',true);return}
  const addr=(document.getElementById('deliveryAddress').value||'').trim();
  if(addr.length<3){toast('Enter a delivery address',true);return}
  const total=cart.reduce((s,i)=>s+i.price*i.qty,0);
  const orderObj={uid:currentUser.uid,userName:currentUser.displayName||currentUser.email.split('@')[0],userEmail:currentUser.email,items:[...cart],total,deliveryAddress:addr,status:'pending'};
  try{
    // Save to Firestore (done in module script below via window.saveOrder)
    const orderId=await window.saveOrder(orderObj);
    toast('Order placed successfully!');
    cart=[];saveCart();renderCartBody();CM.classList.remove('open');
    await postToScript({action:'new_order',orderId,orderDate:new Date().toISOString(),name:orderObj.userName,email:orderObj.userEmail,address:addr,orderItemsText:orderObj.items.map(i=>`${i.title} x${i.qty} ‚Äî ‚Çπ${i.price*i.qty}`).join('\n'),totalPrice:'‚Çπ'+total,adminEmail:ADMIN_EMAIL});
    await loadOrders();
  }catch(e){toast('Order failed: '+e.message,true)}
}

async function postToScript(payload){
  try{const res=await fetch(APP_SCRIPT_URL,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});return res}catch(e){console.warn('Script post failed',e)}
}

window.resendEmail=async function(orderId){
  if(!currentUser){toast('Sign in to resend',true);return}
  try{
    const data=await window.getOrder(orderId);if(!data){toast('Order not found',true);return}
    await postToScript({action:'resend_order',orderId,...data});
    toast('Resend requested');
  }catch(e){toast('Resend failed',true)}
};

loadCart();
loadProducts();
</script>

<!-- FIREBASE MODULE -->
<script type="module">
import{initializeApp}from"https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
import{getAuth,GoogleAuthProvider,signInWithPopup,createUserWithEmailAndPassword,signInWithEmailAndPassword,signOut,onAuthStateChanged,updateProfile}from"https://www.gstatic.com/firebasejs/12.2.1/firebase-auth.js";
import{getFirestore,doc,setDoc,getDoc,addDoc,collection,query,where,getDocs,orderBy,serverTimestamp,updateDoc}from"https://www.gstatic.com/firebasejs/12.2.1/firebase-firestore.js";

const app=initializeApp({apiKey:"AIzaSyDWmliHHP7UR1pmM6CNjY6o_NvF-hYJWpY",authDomain:"minibotix-a1b9a.firebaseapp.com",projectId:"minibotix-a1b9a",storageBucket:"minibotix-a1b9a.firebasestorage.app",messagingSenderId:"771169717230",appId:"1:771169717230:web:44848d73e548d0e0f8dcff"});
const auth=getAuth(app),db=getFirestore(app),gp=new GoogleAuthProvider();
const g=id=>document.getElementById(id);

/* EXPOSE FIRESTORE HELPERS TO GLOBAL SCOPE */
window.saveOrder=async function(orderObj){
  const ref=await addDoc(collection(db,'orders'),{...orderObj,createdAt:serverTimestamp()});
  // clear cart snapshot
  if(orderObj.uid){const cs=doc(db,'users',orderObj.uid,'meta','cartSnapshot');await setDoc(cs,{cart:[],total:0,updatedAt:serverTimestamp()})}
  return ref.id;
};
window.getOrder=async function(orderId){
  const snap=await getDoc(doc(db,'orders',orderId));
  return snap.exists()?snap.data():null;
};

async function persistCart(){
  if(!currentUser)return;
  try{await setDoc(doc(db,'users',currentUser.uid,'meta','cartSnapshot'),{cart,total:cart.reduce((s,i)=>s+i.price*i.qty,0),updatedAt:serverTimestamp()})}catch(e){console.warn(e)}
}
window.persistCart=persistCart;

async function loadOrders(){
  if(!currentUser){g('ordersLead').textContent='Sign in to view your order history.';g('ordersList').innerHTML='';return}
  g('ordersLead').textContent='Your recent orders are shown below.';
  try{
    const q=query(collection(db,'orders'),where('uid','==',currentUser.uid),orderBy('createdAt','desc'));
    const snap=await getDocs(q);
    const orders=[];snap.forEach(d=>orders.push({id:d.id,...d.data()}));
    const list=g('ordersList');
    list.innerHTML='';
    if(!orders.length){list.innerHTML='<div class="empty-state"><div class="ei">üìã</div><p>No orders yet.</p></div>';return}
    orders.forEach(o=>{
      const date=o.createdAt&&o.createdAt.toDate?o.createdAt.toDate().toLocaleString():'‚Äî';
      const items=(o.items||[]).map(it=>`<div class="order-item"><span>${it.title} √ó ${it.qty}</span><span>‚Çπ${(it.price*it.qty).toLocaleString()}</span></div>`).join('');
      const row=document.createElement('div');row.className='order-row';
      row.innerHTML=`
        <div class="order-meta">
          <div>
            <div class="order-id"># ${o.id}</div>
            <div class="order-date">${date} ¬∑ ${(o.items||[]).length} item(s)</div>
          </div>
          <div style="text-align:right;display:flex;flex-direction:column;align-items:flex-end;gap:8px">
            <div class="order-total">‚Çπ${Number(o.total||0).toLocaleString()}</div>
            <div class="order-status">${o.status||'pending'}</div>
          </div>
        </div>
        <div class="order-items">${items}</div>
        <div style="display:flex;gap:8px;margin-top:12px;justify-content:flex-end">
          <button class="btn-o" style="font-size:11px;padding:7px 12px" onclick="resendEmail('${o.id}')">Resend Email</button>
        </div>`;
      list.appendChild(row);
    });
  }catch(e){console.warn(e)}
}
window.loadOrders=loadOrders;

/* AUTH EVENTS */
g('googleSignIn').addEventListener('click',async()=>{try{const r=await signInWithPopup(auth,gp);await setDoc(doc(db,'users',r.user.uid),{name:r.user.displayName,email:r.user.email,photoURL:r.user.photoURL,lastSignIn:serverTimestamp()},{merge:true});document.getElementById('authModal').classList.remove('open');toast('Signed in with Google')}catch(e){toast('Google sign-in failed',true)}});
g('emailSignIn').addEventListener('click',async()=>{try{await signInWithEmailAndPassword(auth,g('loginEmail').value.trim(),g('loginPassword').value);document.getElementById('authModal').classList.remove('open');toast('Signed in')}catch(e){toast('Sign in failed: '+e.message,true)}});
g('createAccount').addEventListener('click',async()=>{const name=g('regName').value.trim(),phone=g('regPhone').value.trim(),email=g('regEmail').value.trim(),pass=g('regPass').value,pass2=g('regPass2').value;if(pass.length<6){toast('Password min 6 chars',true);return}if(pass!==pass2){toast('Passwords do not match',true);return}try{const uc=await createUserWithEmailAndPassword(auth,email,pass);await updateProfile(uc.user,{displayName:name});await setDoc(doc(db,'users',uc.user.uid),{name,phone,area:'',email,createdAt:serverTimestamp()});document.getElementById('authModal').classList.remove('open');toast('Account created!')}catch(e){toast('Register failed: '+e.message,true)}});

onAuthStateChanged(auth,async user=>{
  currentUser=user||null;
  if(user){
    g('sou').style.display='none';g('sui').style.display='block';g('cartWrap').style.display='flex';
    const snap=await getDoc(doc(db,'users',user.uid));
    if(!snap.exists())await setDoc(doc(db,'users',user.uid),{name:user.displayName||'',phone:'',area:'',email:user.email||'',createdAt:serverTimestamp()});
    const ud=(await getDoc(doc(db,'users',user.uid))).data();
    g('pName').textContent=(ud.name||user.email||'User').split(' ')[0];
    g('pAvatar').src=user.photoURL||'file.svg';
    g('pfName').value=ud.name||'';g('pfPhone').value=ud.phone||'';g('pfArea').value=ud.area||'';
    // load cart snapshot
    try{const cs=await getDoc(doc(db,'users',user.uid,'meta','cartSnapshot'));if(cs.exists()&&(cs.data().cart||[]).length){cart=cs.data().cart;saveCart()}}catch(e){}
    await loadOrders();
  }else{
    g('sou').style.display='block';g('sui').style.display='none';g('cartWrap').style.display='none';
    g('ordersLead').textContent='Sign in to view your order history.';
    g('ordersList').innerHTML='';
  }
});
g('saveProfile').addEventListener('click',async()=>{if(!currentUser){toast('Not signed in',true);return}const name=g('pfName').value.trim(),phone=g('pfPhone').value.trim(),area=g('pfArea').value.trim();try{await updateDoc(doc(db,'users',currentUser.uid),{name,phone,area,updatedAt:serverTimestamp()});await updateProfile(currentUser,{displayName:name});g('pName').textContent=name.split(' ')[0];document.getElementById('profileModal').classList.remove('open');toast('Profile saved')}catch(e){toast('Save failed: '+e.message,true)}});
g('logoutBtn').addEventListener('click',async()=>{await signOut(auth);document.getElementById('profileModal').classList.remove('open');toast('Signed out')});
</script>
</body>
</html>
